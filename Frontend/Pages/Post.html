<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Create Post</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /*  THEME VARIABLES  */
    :root {
      --bg-color: #f4f6f9;
      --card-bg: #ffffff;
      --text-color: #212529;
      --border-color: #dee2e6;
    }

    body.dark {
      --bg-color: #0f1115;
      --card-bg: #1f232b;
      --text-color: #f1f3f5;
      --border-color: #3a3f4b;
    }

    /*  BASE  */
    body {
      margin: 0;
      min-height: 100vh;
      background: var(--bg-color);
      /* background: url('https://i2.wp.com/files.123freevectors.com/wp-content/original/106989-light-abstract.jpg?w=800&q=95') no-repeat center center fixed; */
      background-size: cover;
      font-family: sans-serif;
      color: var(--text-color);
      transition: background 0.3s ease, color 0.3s ease;
    }

    /*  TOP BAR  */
    .top-bar {
      background: var(--card-bg);
      border-bottom: 1px solid var(--border-color);
    }

    /*  THEME TOGGLE  */
    .theme-toggle {
      border: 1px solid var(--border-color);
      background: transparent;
      color: var(--text-color);
      padding: 6px 14px;
      border-radius: 20px;
      cursor: pointer;
      transition: background 0.2s ease, transform 0.2s ease;
    }

    .theme-toggle:hover {
      background: rgba(13,110,253,0.08);
      transform: scale(1.03);
    }

    /*  FORM CARD  */
    .formdiv {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
      width: 100%;
      max-width: 500px;
      transition: background 0.3s ease;
    }

    .form-label {
      color: var(--text-color);
    }

    .form-control {
      background: var(--card-bg);
      color: var(--text-color);
      border-color: var(--border-color);
    }

    .form-control:focus {
      box-shadow: none;
      border-color: #0d6efd;
    }

    /* POST BUTTON  */
    #postBtn {
      background-image: linear-gradient(to right, rgb(139,92,256), rgb(14,165,233));
      color: rgb(247,255,250);
      border: none;
      transition: transform 0.2s ease, opacity 0.2s ease;
    }

    #postBtn:hover {
      transform: scale(1.03);
      opacity: 0.95;
    }

    /* RESPONSIVE  */
    @media (max-width: 576px) {
      .formdiv {
        margin: 20px;
      }
    }
    
  </style>
</head>

<body>

  <!-- TOP BAR -->
  <div class="top-bar">
    <div class="container py-3 d-flex justify-content-between align-items-center">
      <a href="/Frontend/Pages/Feed.html" class="btn btn-outline-primary">
        ‚Üê Back
      </a>

      <button class="theme-toggle" id="themeToggle">
        üåô Dark Mode
      </button>
    </div>
  </div>

  <!-- FORM -->
  <div class="d-flex justify-content-center align-items-center flex-grow-1">
    <form class="formdiv" id="postForm">
      <h3 class="text-center mb-4">Create New Post</h3>

      <div class="mb-3">
        <label for="posttitle" class="form-label">Post Title</label>
        <input
          type="text"
          class="form-control"
          id="posttitle"
          placeholder="Enter title here"
          name="postTitle"
          required
        >
      </div>

      <div class="mb-3">
        <label for="descriptive" class="form-label">Description</label>
        <textarea
          class="form-control"
          id="descriptive"
          rows="5"
          name="postDescription"
          placeholder="Write your post..."
          required
        ></textarea>
      </div>

      <button type="submit" class="btn w-100 mt-2" id="postBtn">
        Post It üöÄ
      </button>
    </form>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const form = document.getElementById('postForm');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const formData = new URLSearchParams(new FormData(form));
      formData.append('userID', localStorage.getItem('userID'));

      const response = await fetch('http://localhost:3000/createpost', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: formData
      });

      const text = await response.text();
      alert(text);

      if (response.status === 200) {
        window.location.href = "/Frontend/Pages/Feed.html";
      }
    });
  </script>

  <!-- THEME TOGGLE SCRIPT -->
  <script>
    const toggleBtn = document.getElementById("themeToggle");
    const bodyEl = document.body;

    const savedTheme = localStorage.getItem("theme");
    if (savedTheme === "dark") {
      bodyEl.classList.add("dark");
      toggleBtn.textContent = "‚òÄÔ∏è Light Mode";
    }

    toggleBtn.addEventListener("click", () => {
      bodyEl.classList.toggle("dark");
      const isDark = bodyEl.classList.contains("dark");
      toggleBtn.textContent = isDark ? "‚òÄÔ∏è Light Mode" : "üåô Dark Mode";
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });
  </script>

</body>
</html>
